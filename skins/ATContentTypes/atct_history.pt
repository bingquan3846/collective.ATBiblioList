<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
<body>

<metal:main fill-slot="main">
    <tal:main-macro metal:define-macro="main"
    tal:define="histories here/getDocumentComparisons">
    <h1 tal:content="string:Changes to ${here/Title}" class="documentFirstHeading">History</h1>

    <div class="documentDescription" i18n:translate="atct_lastchanges_description">
    Shows the last changes of the item, with new content in green (normal text),
    and deleted content in red (strike-out text).
    </div>

    <div class="portalMessage" i18n:translate="atct_lastchanges_warning">
    This changelog will be emptied when the site administrator performs maintenance
    (packing) of the database, and is only provided for your convenience. If the item
    has no history, it normally means that no changes have been made since the last time
    the history log was removed by the administrator.
    </div>

    <tal:histories tal:repeat="history histories" tal:condition="histories">
      <h2>Comparison between
          <span tal:content="python:here.toPortalTime(history['oldTime'], 1)" />
          and
         <span tal:content="python:here.toPortalTime(history['newTime'], 1)" />
      </h2>

      <dl>
       <dt>Comment</dt>
       <dd tal:content="history/description" />
       <dt>User</dt>
       <dd tal:content="history/member/fullname | history/user" />
      </dl>
      <fieldset>
          <legend>Changes in this revision</legend>
          <span tal:replace="structure python:here.formatHistoryDiff(history['lines'])">
          The changes, with color coding.
          </span>
      </fieldset>

    </tal:histories>

    <tal:nohistories tal:condition="not: histories">
      <p i18n:translate="atct_lastchanges_notavailable">
       No changes available for this document
      </p>
    </tal:nohistories>

    </tal:main-macro>
</metal:main>

</body>
</html>
