==============================================
Quick switching instructions for the impatient
==============================================

 * Back up your data! Seriously! This thing may break your content, it is still
   experimental. But we need your feedback to make the migration perfect, so
   please install and convert your site on a backup instance, and report any
   failures/errors to us, so we can fix them.
   
 * You have to do two things to migrate the types and switch to the new ones:
 
   * Go to the external method 'migrateFromCMFtoATCT' in the ZMI of your portal
     root. Run it using the 'test' tab. This will move all your content to the
     new types.
     
   * Go to the external method 'switchCMF2ATCT' in the ZMI of your portal
     root. Run it using the 'test' tab. This will rename the AT-based content
     types to the default type names - and rename/hide the CMF-based ones.

  * Your types are now be transferred to the new AT-based variants, and set as
    the default types.
    
  * Don't forget to report any migration failures in the ATCT bug tracker on SF:
    http://tinyurl.com/5brwn - we need your bug report to make migration as smooth
    as possible!
    
       
============
Requirements
============

Zope 2.7+, 2.6.2, 2.6.4
-----------------------

AT Content Types requires Zope 2.7.x or Zope 2.6.2/2.6.4+. For Zope 2.6.2/2.6.4
you *must* get a fix for the Interface package to fix an issue with nested
interfaces. Get the file Implements.py from the Zope Corp. cvs server at
http://cvs.zope.org/Zope/lib/python/Interface/?only_with_tag=Zope-2_6-branch and
copy it to ZOPE_HOME/lib/python/Interface/. Without it some features may not
work or even break silently!
You shouldn't use 2.6.1 or 2.6.3 due some evil bugs. Zope 2.7.x is recommanded 
because of the ordered folder interface.

NOTE: ATCT will soon drop support for Zope < 2.7.2

Python 2.3.3+
----------------------

AT Content Types requires some new features of Python 2.3.3+.


Archetypes 1.3.1-final
--------------------

AT Content Types is tested with the following AT versions

 * AT 1.3.1-final newer releases of AT 1.3.1

 * AT SVN anon bundle after 2004-12-01
   http://svn.plone.org/archetypes/bundles/anon-archetypes-1.3/

AT Content Types doesn't work with other versions of Archetypes because some
fixes are missing. Right now it's tested only with the newest cvs version of
Archetypes.

AT Content Types doesn't work with AT 1.2.x or older!


PortalTransforms
----------------

AT Content Types requires the CVS version of PortalTransforms. All older
versions are missing some important bugfixes.

   Note: Please use the version of PT that is bundled with AT Content Types.
         It's the latest developer checkout.

Because PortalTransforms has a problem updating the tools you *must* remove the
mimetypes_registry and portal_transforms manually and reinstall PortalTransforms
using the Quickinstaller. Otherwise some features of AT Content Types may not
work or worse AT Content Types may break.

Docutils for restructured text
------------------------------

You have to install a new version of docutils for Zope 2.7.0! Zope 2.7.1+ will
be shipped with docutils 0.3.3. You can download docutils at
http://docutils.sf.net/. Either you have to remove
ZOPE_HOME/lib/python/docutils after installing docutils or you have to replace
Zope's version by docutils 0.3.3+.

Plone
-----

AT Content Types requires the templates and icon of CMFPlone for viewing the
types and AT Folder requires some code from PloneFolder, too. It should be easy
to seperate the dependecies if needed.

AT Content Types should work with Plone 2.0 but for better results use Plone
2.0.3 or update CMFPlone to the latest branches/tiran-atct-integration 
subversion version from http://svn.plone.org/


=====================
Optional Requirements
=====================

mxTidy
------

Install egenix mxTidy to enable the validation of the body text of ATDocument.
The text is checked and is rejected if it contains wrong xhtml syntax that may
break the user interface of plone. 
You can download mxTidy from http://www.egenix.com/files/python/mxTidy.html


TextIndexNG 2.0.8+
------------------

If you want to use TextIndexNG to index the SearchableText attribute you should
install version 2.0.7 or higher. Only newer versions uses the special hook that
allows indexing the containment of ATFile.
You can download TextIndexNG from http://zope.org/Members/ajung/TextIndexNG/


PortalTransforms helper applications
------------------------------------

You should install all helpers application for PortalTransforms.
For debian users:
apt-get install lynx pdftohtml wv xsltproc tidy \
                unrtf ppthtml xlhtml gs-common xpdf-utils catdoc

Python Imaging Library (PIL)
----------------------------

In order to enable the auto resizing feature of ATImage (Archetypes ImageField)
you have to install PIL also known as python-imaging or Python Imaging Library.
It's available under http://www.pythonware.com/products/pil/


ExternalStorage
---------------

ExternalStorage (ES) is required to store images and files on the file system
instead of storing them in the ZODB.
NOTE FOR ZEO: You have to sync the clients file repositories manually (e.g. by 
              using rsync)

============
Installation
============

Use the QuickInstaller to install AT Content Types. You should install
Archetypes and PortalTransform before installing AT Content Types.


=======================
Reconfiguration of Zope
=======================

You need to reconfigure Zope to make it play nice with Plone and AT Content
Types.

At first you need to set reST header level to 2. For Zope 2.7 change the 
etc/zope.conf and adjust the environment section in the config file:

<environment>
    STX_DEFAULT_LEVEL 2
</environment>

For Zope 2.6 define a environment var. For a un*x bash script:

export STX_DEFAULT_LEVEL=2

For Windows:
@set STXT_DEFAULT_LEVEL=2

For Zope 2.7 you also must set the rest-input-encoding and rest-out-encoding
to the same encoding you are using as site-encoding for Plone. I suggest using
utf-8 everywhere.

========================
Migration from CMF types
========================

** BACKUP ** ** BACKUP ** ** BACKUP ** ** BACKUP ** ** BACKUP ** ** BACKUP **

             YOU MUST (!) BACKUP YOUR ZODB BEFORE MIGRATING!

** BACKUP ** ** BACKUP ** ** BACKUP ** ** BACKUP ** ** BACKUP ** ** BACKUP **

Migration may fail and it could destroy your data. So please backup your ZODB
before migrating to AT Content Types.

Go to the external method 'migrateFromCMFtoATCT' in the ZMI of your portal root.
Run it using the 'test' tab.


==============================
Migration from CMF Plone Types
==============================

Migration from CMF Plone Types to AT Content Types is less tested but should
work like the migration from CMF types.
There is an external method available for migration. See migrateFromCMFtoATCT
and replace 'CMF' by 'CPT'
